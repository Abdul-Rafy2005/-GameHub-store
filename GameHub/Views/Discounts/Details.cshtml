@model GameHub.Models.Discount
@{
    ViewBag.Title = "Discount Details";
    var now = DateTime.UtcNow;
    var isActive = (!Model.StartDate.HasValue || Model.StartDate <= now) && (!Model.EndDate.HasValue || Model.EndDate >= now);
    var games = Model.Games?.ToList() ?? new List<GameHub.Models.Game>();
}

<div class="hero-banner" style="background-image:url('/Content/hero-placeholder.jpg')">
    <div class="overlay">
        <h1 class="display-6"><i class="bi bi-tag"></i> Discount Code Details</h1>
        <p class="lead">@Model.DiscountName</p>
    </div>
</div>

<div class="row g-4">
    <div class="col-lg-6">
        <div class="panel-dark p-4">
            <h5 class="mb-3"><i class="bi bi-info-circle"></i> Discount Information</h5>
            <div class="detail-row">
                <span class="label">Discount Code</span>
                <span class="value"><code class="text-info fs-5">@Model.DiscountName</code></span>
            </div>
            <div class="detail-row">
                <span class="label">Discount Amount</span>
                <span class="value"><span class="badge bg-success fs-6">@(Model.DiscountPercent ?? 0)% OFF</span></span>
            </div>
            <div class="detail-row">
                <span class="label">Status</span>
                <span class="value">
                    @if (isActive) { <span class="badge bg-success"><i class="bi bi-check-circle"></i> Active</span> }
                    else if (Model.EndDate.HasValue && Model.EndDate < now) { <span class="badge bg-secondary"><i class="bi bi-x-circle"></i> Expired</span> }
                    else { <span class="badge bg-warning text-dark"><i class="bi bi-clock"></i> Scheduled</span> }
                </span>
            </div>
            <div class="detail-row">
                <span class="label">Start Date</span>
                <span class="value">@(Model.StartDate.HasValue ? Model.StartDate.Value.ToString("MMM dd, yyyy HH:mm") : "Immediate")</span>
            </div>
            <div class="detail-row">
                <span class="label">End Date</span>
                <span class="value">@(Model.EndDate.HasValue ? Model.EndDate.Value.ToString("MMM dd, yyyy HH:mm") : "No Expiration")</span>
            </div>
            <div class="detail-row">
                <span class="label">Applicable Games</span>
                <span class="value"><span class="badge badge-soft">@games.Count game(s)</span></span>
            </div>

            <div class="mt-4">
                <a href="@Url.Action("Edit", new { id = Model.DiscountID })" class="btn btn-accent"><i class="bi bi-pencil"></i> Edit Discount</a>
                <a href="@Url.Action("Index")" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> Back to List</a>
            </div>
        </div>
    </div>

    <div class="col-lg-6">
        <div class="panel-dark p-4">
            <h5 class="mb-3"><i class="bi bi-controller"></i> Applicable Games</h5>
            @if (games.Any())
            {
                <div class="game-chips">
                    @foreach (var game in games.OrderBy(g => g.Title))
                    {
                        <div class="game-chip">
                            <img src="/Content/covers/@(game.GameID).jpg" onerror="this.src='/Content/cover-placeholder.jpg'" />
                            <div class="game-chip-info">
                                <div class="game-chip-title">@game.Title</div>
                                <div class="game-chip-price">
                                    <span class="original">$@game.Price</span>
                                    <span class="discounted">$@((game.Price * (1 - (Model.DiscountPercent ?? 0) / 100)).ToString("0.00"))</span>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="text-center text-muted py-4">
                    <i class="bi bi-inbox display-6"></i>
                    <p class="mt-2">No games assigned to this discount yet.</p>
                    <a href="@Url.Action("Edit", new { id = Model.DiscountID })" class="btn btn-sm btn-accent mt-2">Assign Games</a>
                </div>
            }
        </div>
    </div>
</div>

@section Styles {
<style>
.detail-row { display:flex; justify-content:space-between; align-items:center; padding:12px 0; border-bottom:1px solid rgba(255,255,255,.05); }
.detail-row .label { color:#8fa5b8; font-size:.9rem; }
.detail-row .value { font-weight:600; color:#e6f4ff; }
.game-chips { display:grid; gap:12px; max-height:500px; overflow-y:auto; }
.game-chip { display:flex; gap:12px; background:rgba(10,15,20,.6); border:1px solid rgba(255,255,255,.08); border-radius:8px; padding:10px; transition:.2s; }
.game-chip:hover { background:rgba(102,192,244,.1); transform:translateX(4px); }
.game-chip img { width:60px; height:60px; object-fit:cover; border-radius:6px; }
.game-chip-info { flex:1; display:flex; flex-direction:column; justify-content:center; }
.game-chip-title { font-weight:600; color:#e6f4ff; font-size:.9rem; }
.game-chip-price { margin-top:4px; }
.game-chip-price .original { text-decoration:line-through; color:#8ca5b6; font-size:.8rem; margin-right:8px; }
.game-chip-price .discounted { color:#9fd7b4; font-weight:700; font-size:.95rem; }
.game-chips::-webkit-scrollbar { width:6px; }
.game-chips::-webkit-scrollbar-thumb { background:rgba(102,192,244,.3); border-radius:3px; }
</style>
}
